# WMIC (Windows Management Instrumentation Command-Line)
# perhaps the most useful command line tool but its output format sucks for parsing

# get help
wmic /?

# determine whether service auto-starts on boot ie. StartMode=Auto
wmic service where caption="SERVICE" get name, caption, state, startmode

# list svc which start auto and may be writable
wmic service get name,displayname,pathname,startmode | findstr /i "auto" | findstr /i /v "c:\windows"

# list installed patches
wmic qfe get Caption,Description,HotFixID,InstalledOn
wmic qfe get Caption,Description,HotFixID,InstalledOn | findstr /C:"KB.." /C:"KB.."


# Fully explaining the use of WMIC would take a tutorial all of it's own.
# see also:
# https://fuzzysecurity.com/tutorials/16.html
# https://web.archive.org/web/20080523074510/https://synjunkie.blogspot.com/2008/03/command-line-ninjitsu.html
# https://www.computerhope.com/wmic.htm