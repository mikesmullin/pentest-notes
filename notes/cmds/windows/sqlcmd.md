# ---
# MS-SQL   mssql
# SQLCMD

# see: https://openwritings.net/pg/ms-sql-server/ms-sql-command-line-cheatsheet

## List Databases
C:\> sqlcmd -S .\SQLEXPRESS -E -Q "select name from sys.databases"

name                                                                                                                            
-------------
master                                                                                                                          
tempdb                                                                                                                          
model                                                                                                                           
msdb                                                                                                                            

(4 rows affected)

# or (this one doesn't work as well)
C:\> sqlcmd -E -S localhost -Q "EXEC sp_databases;"

## List Tables in Database
C:\> sqlcmd -E -S localhost -Q "SELECT * FROM DatabaseName.information_schema.tables;" -W -w 999 -s"," -o "c:\windows\temp\RecruiterProd_MSCRM_tables.csv"

## Retrieve table contents
C:\> sqlcmd -E -S localhost -d DatabaseName -Q "SELECT * FROM SystemUserBase;" -W -w 999 -s","
C:\> sqlcmd -E -S localhost -d DatabaseName -Q "SELECT * FROM SystemUserBase;" -W -w 999 -s"," -o "c:\windows\temp\RecruiterProd_MSCRM_userbase.csv"

## Dump MSSQL Password Hashes
C:\> sqlcmd -E -S localhost -Q "SELECT name, password_hash FROM master.sys.sql_logins;"






# with known user/pass
sqlcmd -S localhost -U SA -P $PASSWORD


# On every SQL Server instance there is a number of default system databases. Those are"
# 
#     master - keeps the information for an instance of SQL Server.
#     msdb - used by SQL Server Agent.
#     model - template database copied for each new database.
#     resource - read only database that keeps system objects that are visible in every database on the server in sys schema.
#     tempdb - keeps temporary objects for SQL queries.
